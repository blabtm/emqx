Refactored data integration resource manager state machine, which should eliminate a few race conditions that could lead to inconsistent states.
